apiVersion: 1

contactPoints:
  - orgId: 1
    name: grafana-default-email
    receivers:
      - uid: default-email
        type: email
        settings:
          addresses: performance-alerts@example.com
          subject: "ðŸ”” CAPSIM Performance Alert"
          body: |
            **Alert**: {{ .GroupLabels.alertname }}
            
            **Status**: {{ .Status }}
            **Severity**: {{ .CommonLabels.severity }}
            **Time**: {{ .StartsAt.Format "2006-01-02 15:04:05" }}
            
            {{ range .Alerts }}
            **Description**: {{ .Annotations.description }}
            **Summary**: {{ .Annotations.summary }}
            {{ end }}
            
            [View Dashboard]({{ .ExternalURL }}/d/performance-tuning)
            
            ---
            Generated by CAPSIM Performance Monitoring System

  - orgId: 1
    name: performance-alerts-email
    receivers:
      - uid: perf-email
        type: email
        settings:
          addresses: performance-alerts@example.com
          subject: "ðŸš¨ URGENT: CAPSIM Performance SLA Violation"
          body: |
            # ðŸš¨ Performance Alert: {{ .GroupLabels.alertname }}
            
            **ðŸŽ¯ SLA Violation Detected!**
            
            | Field | Value |
            |-------|-------|
            | **Alert** | {{ .GroupLabels.alertname }} |
            | **Status** | {{ .Status }} |
            | **Severity** | {{ .CommonLabels.severity }} |
            | **Component** | {{ .CommonLabels.component }} |
            | **Time** | {{ .StartsAt.Format "2006-01-02 15:04:05" }} |
            
            ## Details
            {{ range .Alerts }}
            **Summary**: {{ .Annotations.summary }}
            **Description**: 
            {{ .Annotations.description }}
            
            **Current Value**: {{ .ValueString }}
            {{ end }}
            
            ## Actions Required
            1. Check system resources immediately
            2. Consider applying performance tuning levers
            3. Monitor for thermal throttling (if CPU temp alert)
            4. Review recent changes that might affect performance
            
            ## Quick Links
            - [Performance Dashboard]({{ .ExternalURL }}/d/performance-tuning)
            - [System Overview]({{ .ExternalURL }}/d/system-overview)
            - [PostgreSQL Metrics]({{ .ExternalURL }}/d/postgres-stats)
            
            ---
            **Automated Alert from CAPSIM Performance Tuning System**

  - orgId: 1
    name: performance-alerts-browser
    receivers:
      - uid: browser-push
        type: webhook
        settings:
          url: "http://localhost:8000/api/notifications/browser-push"
          httpMethod: POST
          title: "CAPSIM Performance Alert"
          maxAlerts: 5
          body: |
            {
              "title": "ðŸš¨ {{ .GroupLabels.alertname }}",
              "body": "{{ range .Alerts }}{{ .Annotations.summary }}{{ end }}",
              "icon": "/static/alert-icon.png",
              "badge": "/static/badge.png",
              "tag": "performance-alert",
              "requireInteraction": true,
              "actions": [
                {
                  "action": "view-dashboard",
                  "title": "View Dashboard"
                },
                {
                  "action": "dismiss",
                  "title": "Dismiss"
                }
              ],
              "data": {
                "alertname": "{{ .GroupLabels.alertname }}",
                "severity": "{{ .CommonLabels.severity }}",
                "dashboard_url": "{{ .ExternalURL }}/d/performance-tuning"
              }
            }

  - orgId: 1
    name: slack-alerts
    receivers:
      - uid: slack-webhook
        type: slack
        settings:
          url: "https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK"
          channel: "#performance-alerts"
          username: "CAPSIM-Monitoring"
          iconEmoji: ":warning:"
          title: "ðŸš¨ CAPSIM Performance Alert"
          text: |
            **{{ .GroupLabels.alertname }}** - {{ .Status }}
            
            {{ range .Alerts }}
            *Summary:* {{ .Annotations.summary }}
            *Description:* {{ .Annotations.description }}
            {{ end }}
            
            <{{ .ExternalURL }}/d/performance-tuning|View Dashboard> 