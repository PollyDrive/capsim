# Capsim: Агентно-ориентированный генератор данных

[![Python Version](https://img.shields.io/badge/python-3.11%2B-blue.svg)](https://www.python.org/)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![made-with-love](https://img.shields.io/badge/Made%20with-❤️-ff69b4.svg)]()

Продвинутый генератор данных, который создает реалистичные, взаимосвязанные транзакционные данные путем симуляции микро-экономики виртуальных агентов. Этот проект задуман как идеальный источник данных для тестирования и демонстрации дата-инженерных пайплайнов (например, Kafka, Spark, Airflow, dbt) и аналитических систем.

## О проекте

Вместо использования статичных CSV-файлов или простых скриптов со случайными данными, **Capsim** строит динамический мир, в котором 1000 агентов живут, работают и взаимодействуют. Каждое действие агента — от покупки продуктов до публикации поста в соцсетях — логируется как структурированное событие. Это создает богатый, развивающийся датасет, полный логических паттернов, трендов и аномалий, который подходит для сложных задач по обработке данных.

### Ключевые концепции

*   **Агентно-ориентированная модель:** Симуляция населена 1000 агентами, каждый из которых обладает уникальными демографическими, финансовыми и социальными атрибутами, сгенерированными с использованием реалистичных распределений.
*   **Динамическая экономика:** Агенты имеют профессии, получают ежедневный доход, управляют бюджетами (время, энергия, деньги) и принимают решения о покупках на основе своего состояния.
*   **Событийно-ориентированная архитектура:** Каждое действие агента фиксируется как отдельное событие и сохраняется в базе данных PostgreSQL, формируя чистый транзакционный лог.
*   **"Режим Бога" (God Mode):** На симуляцию можно влиять с помощью глобальных внешних факторов (например, новые законы или социальные тренды), определенных в конфигурационном файле, что позволяет проводить контролируемые эксперименты.

## Технологический стек

*   **Язык:** Python 3.11+
*   **Валидация данных и конфигурация:** Pydantic, Faker
*   **CLI:** Typer
*   **База данных:** PostgreSQL
*   **Контейнеризация:** Docker & Docker Compose
*   **Управление зависимостями:** Poetry

## Начало работы

Следуйте этим шагам, чтобы настроить и запустить локальное окружение для разработки.

### Предварительные требования

*   [Docker](https://www.docker.com/get-started) и Docker Compose
*   [Poetry](https://python-poetry.org/docs/#installation) для управления зависимостями Python

### Установка и настройка

1.  **Клонируйте репозиторий:**
    ```
    git clone https://your-repository-url.com/capsim.git
    cd capsim
    ```

2.  **Запустите базу данных PostgreSQL:**
    Эта команда запустит контейнер PostgreSQL в фоновом режиме, используя настройки из файла `docker-compose.yml`.
    ```
    docker-compose up -d
    ```

3.  **Настройте подключение к базе данных:**
    Скопируйте шаблон конфигурации и впишите ваши учетные данные. Учетные данные по умолчанию находятся в файле `docker-compose.yml` (`user: user`, `password: password`).
    ```
    cp config/database.ini.template config/database.ini
    ```
    Теперь отредактируйте файл `config/database.ini`, указав ваши данные.

4.  **Установите зависимости Python:**
    ```
    poetry install
    ```

5.  **Инициализируйте схему базы данных:**
    Этот скрипт подключится к базе данных и создаст таблицы `persons` и `events`.
    ```
    python -m scripts.init_db
    ```

6.  **Наполните базу начальными данными:**
    Этот скрипт создаст 1000 уникальных агентов и сохранит их в таблицу `persons`.
    ```
    python -m scripts.seed_data
    ```

## Использование

Для запуска симуляции используйте главный скрипт. Вы можете указать количество "дней", которое симуляция должна работать.

